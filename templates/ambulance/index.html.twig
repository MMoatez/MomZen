{% extends 'Basefront.html.twig' %}

{% block title %}Gestion des Ambulances{% endblock %}

{% block body %}
    <h1>Gestion des Ambulances</h1>

    {# Formulaire de recherche #}
    <form method="get" action="{{ path('app_ambulance_index') }}">
        <input type="text" 
               name="search" 
               value="{{ search|default('') }}" {# Gestion de l'absence de valeur #}
               placeholder="Rechercher...">
        <button type="submit">Rechercher</button>
    </form>

    {# Tableau principal #}
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Chauffeur</th>
               <th>
    <a href="{{ path('app_ambulance_index', {
        'sort_by': 'immatriculation', 
        'order': (sort_by|default('') == 'immatriculation' and order|default('asc') == 'asc') ? 'desc' : 'asc'
    }) }}">
        Immatriculation
    </a>
</th>
                <th>Marque</th>
                <th>Modèle</th>
            </tr>
        </thead>
        <tbody>
            {% for ambulance in ambulances %}
                <tr>
                    <td>{{ ambulance.id }}</td>
                    <td>
                        {% if ambulance.chauffeur %}
                            {{ ambulance.chauffeur.nom }} {{ ambulance.chauffeur.prenom }}
                        {% else %}
                            <span class="text-muted">Aucun chauffeur</span>
                        {% endif %}
                    </td>
                    <td>{{ ambulance.immatriculation }}</td>
                    <td>{{ ambulance.marque }}</td>
                    <td>{{ ambulance.modele }}</td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="5" class="text-center">Aucune ambulance trouvée</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{{ path('app_ambulance_map') }}" class="btn btn-primary">
        <i class="fas fa-map-marker-alt"></i> Voir la carte
    </a>
{% endblock %}